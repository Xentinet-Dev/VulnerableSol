/**
 * Vulnerability severity levels
 */
export enum Severity {
  CRITICAL = "CRITICAL",
  HIGH = "HIGH",
  MEDIUM = "MEDIUM",
  LOW = "LOW",
  INFO = "INFO"
}

/**
 * Vulnerability categories
 */
export enum VulnerabilityCategory {
  SOLANA_ACCOUNT_LIFECYCLE = "Solana Account Lifecycle",
  REENTRANCY = "Reentrancy",
  ORACLE_MANIPULATION = "Oracle Manipulation",
  GOVERNANCE = "Weak Governance",
  LOGIC_ERROR = "Faulty Logic",
  ACCESS_CONTROL = "Access Control",
  ARITHMETIC = "Arithmetic Error"
}

/**
 * Vulnerability detection result
 */
export interface Vulnerability {
  id: string;
  title: string;
  description: string;
  severity: Severity;
  category: VulnerabilityCategory;
  location: {
    file?: string;
    line?: number;
    function?: string;
    contract?: string;
  };
  recommendation: string;
  references?: string[];
  codeSnippet?: string;
  // Additional metadata for simulation
  metadata?: {
    repositoryPath?: string; // Path to cloned repo (for Git scans)
    programPath?: string; // Path to program source
    idlSource?: "repo" | "generated" | "chain" | "inferred-bpf" | "cached"; // Source of IDL if available (PHASE 1: added "cached")
    idl?: any; // IDL data if available
    cachedIdl?: any; // PHASE 1: Cached IDL from scan phase
    [key: string]: any;
  };
}

/**
 * IDL source information
 */
export interface IdlSource {
  source: "repo" | "generated" | "chain" | "inferred-bpf" | "cached"; // PHASE 1: added "cached"
  confidence: number;
}

/**
 * Grouped vulnerability - represents multiple instances of the same vulnerability
 */
export interface GroupedVulnerability {
  // Representative vulnerability (first or most severe instance)
  representative: Vulnerability;
  // All instances of this vulnerability
  instances: Vulnerability[];
  // Count of instances
  count: number;
  // Unique file paths where this vulnerability appears
  affectedFiles: string[];
  // Group key (for deduplication)
  groupKey: string;
}

/**
 * Scan result for a target
 */
export interface ScanResult {
  target: string;
  targetType: "contract" | "git" | "url";
  timestamp: Date;
  vulnerabilities: Vulnerability[];
  summary: {
    total: number;
    critical: number;
    high: number;
    medium: number;
    low: number;
    info: number;
  };
  metadata?: {
    contractAddress?: string;
    network?: string;
    repository?: string;
    url?: string;
    [key: string]: any;
  };
}

