/**
 * Real-World Exploit Database
 * 
 * Comprehensive database of real-world crypto/DeFi exploits (2022-2025)
 * Used for training, testing, and understanding attack patterns
 */

export interface RealWorldExploit {
  id: string;
  name: string;
  date: string;
  chain: string;
  category: string;
  lossAmount: string;
  lossAmountUSD: number;
  attackType: string[];
  description: string;
  technicalDetails: string;
  rootCause: string;
  attackSteps: string[];
  mitigations: string[];
  references: string[];
  relatedExploits?: string[];
}

/**
 * Comprehensive database of real-world exploits
 */
export const REAL_WORLD_EXPLOITS: RealWorldExploit[] = [
  // ===== BRIDGE EXPLOITS =====
  {
    id: "wormhole-2022",
    name: "Wormhole Bridge Exploit",
    date: "February 2022",
    chain: "Solana/Ethereum",
    category: "Bridge",
    lossAmount: "120,000 wETH",
    lossAmountUSD: 320000000,
    attackType: ["type-confusion", "signature-verification-bypass", "bridge-exploit"],
    description: "Attacker bypassed signature verification to mint 120,000 wETH on Solana without proper collateral",
    technicalDetails: "Vulnerability in signature verification process allowed unauthorized minting. Attacker transferred funds to Ethereum. Jump Crypto replenished funds to maintain bridge solvency.",
    rootCause: "Signature verification bypass in bridge contract, allowing unauthorized cross-chain message validation",
    attackSteps: [
      "1. Identified signature verification vulnerability",
      "2. Forged cross-chain message signatures",
      "3. Minted 120,000 wETH on Solana without collateral",
      "4. Transferred funds to Ethereum",
      "5. Bridge became insolvent (later replenished by Jump Crypto)"
    ],
    mitigations: [
      "Robust multi-signature verification",
      "Decentralized validator sets",
      "Enhanced security audits",
      "Rate limiting on bridge operations"
    ],
    references: [
      "Wormhole Bridge Incident Report - February 2022",
      "Beosin Global Web3 Security Report 2022"
    ]
  },
  {
    id: "ronin-2022",
    name: "Ronin Network Exploit",
    date: "March 2022",
    chain: "Ethereum/Axie",
    category: "Bridge",
    lossAmount: "173,600 ETH + 25.5M USDC",
    lossAmountUSD: 624000000,
    attackType: ["private-key-compromise", "bridge-exploit"],
    description: "Attackers compromised private keys to execute fraudulent withdrawals from Ronin bridge",
    technicalDetails: "Compromised private keys of validator nodes allowed attackers to forge withdrawal transactions",
    rootCause: "Private key compromise of validator nodes, weak key management",
    attackSteps: [
      "1. Compromised validator private keys",
      "2. Forged withdrawal transactions",
      "3. Drained 173,600 ETH and 25.5M USDC",
      "4. Transferred funds to multiple addresses"
    ],
    mitigations: [
      "Hardware security modules (HSM)",
      "Multi-signature wallets",
      "Key rotation policies",
      "Separate hot/cold wallet infrastructure"
    ],
    references: [
      "Ronin Network Exploit Analysis - March 2022",
      "Beosin Global Web3 Security Report 2022"
    ]
  },
  {
    id: "nomad-2022",
    name: "Nomad Bridge Exploit",
    date: "August 2022",
    chain: "Multi-chain",
    category: "Bridge",
    lossAmount: "$190M",
    lossAmountUSD: 190000000,
    attackType: ["bridge-exploit", "smart-contract-flaw"],
    description: "Smart contract flaw enabled attackers to drain funds by exploiting message verification",
    technicalDetails: "Vulnerability in message verification allowed attackers to replay or forge messages",
    rootCause: "Smart contract logic error in cross-chain message validation",
    attackSteps: [
      "1. Identified message verification flaw",
      "2. Forged or replayed cross-chain messages",
      "3. Drained funds from bridge",
      "4. Multiple attackers copied the exploit"
    ],
    mitigations: [
      "Enhanced message verification",
      "Nonce tracking and replay protection",
      "Comprehensive security audits",
      "Rate limiting"
    ],
    references: [
      "Nomad Bridge Exploit Analysis - August 2022",
      "Beosin Global Web3 Security Report 2022"
    ]
  },
  {
    id: "bsc-token-hub-2022",
    name: "BSC Token Hub Exploit",
    date: "October 2022",
    chain: "BSC",
    category: "Bridge",
    lossAmount: "2,000,000 BNB",
    lossAmountUSD: 560000000,
    attackType: ["bridge-exploit", "unauthorized-minting"],
    description: "Exploit led to unauthorized creation of 2 million BNB tokens",
    technicalDetails: "Vulnerability in BSC Token Hub bridge contract allowed unauthorized token minting",
    rootCause: "Smart contract vulnerability in bridge's minting mechanism",
    attackSteps: [
      "1. Exploited bridge contract vulnerability",
      "2. Minted 2M BNB tokens without proper authorization",
      "3. Transferred tokens to multiple addresses",
      "4. Attempted to launder funds"
    ],
    mitigations: [
      "Enhanced authorization checks",
      "Multi-signature requirements",
      "Rate limits on minting",
      "Comprehensive audits"
    ],
    references: [
      "BSC Token Hub Exploit - October 2022",
      "Beosin Global Web3 Security Report 2022"
    ]
  },

  // ===== SOLANA DEFI EXPLOITS =====
  {
    id: "cashio-2022",
    name: "Cashio Hack",
    date: "March 2022",
    chain: "Solana",
    category: "DeFi",
    lossAmount: "2B CASH tokens + $52M",
    lossAmountUSD: 52000000,
    attackType: ["missing-ownership-check", "collateral-validation-bypass"],
    description: "Attacker exploited collateral validation flaw to mint 2 billion CASH tokens without legitimate collateral",
    technicalDetails: "Contract failed to properly verify Saber LP token collateral accounts, specifically the `saber_swap.arrow` account's `mint` field. Attacker created fake accounts with worthless tokens.",
    rootCause: "Inadequate validation of collateral account authenticity, missing ownership checks on LP token accounts",
    attackSteps: [
      "1. Identified collateral validation vulnerability",
      "2. Created fake Saber LP token accounts",
      "3. Deposited worthless tokens as collateral",
      "4. Minted 2B CASH tokens without real collateral",
      "5. Exchanged CASH for USDC/UST, draining liquidity pools",
      "6. CASH price dropped from $1 to near zero"
    ],
    mitigations: [
      "Proper account ownership validation",
      "Verify LP token account authenticity",
      "Validate mint fields in collateral accounts",
      "Comprehensive security audits before launch"
    ],
    references: [
      "Halborn: Cashio Hack Explained - March 2022",
      "Helius: Solana Hacks Overview",
      "Cashio Post-Mortem"
    ]
  },
  {
    id: "mango-markets-2022",
    name: "Mango Markets Exploit",
    date: "October 2022",
    chain: "Solana",
    category: "DeFi",
    lossAmount: "$116M",
    lossAmountUSD: 116000000,
    attackType: ["oracle-manipulation", "flash-loan", "pricing-manipulation"],
    description: "Attacker manipulated MNGO token price through low-liquidity oracle feeds to inflate collateral value",
    technicalDetails: "Attacker used low-liquidity oracle feeds to manipulate MNGO price, enabling withdrawal of $116M. Attacker later returned portion after negotiations.",
    rootCause: "Vulnerable oracle implementation using low-liquidity price feeds, no TWAP protection",
    attackSteps: [
      "1. Identified low-liquidity oracle feed for MNGO",
      "2. Manipulated MNGO price through trades",
      "3. Inflated collateral value in Mango Markets",
      "4. Borrowed $116M against manipulated collateral",
      "5. Withdrew funds",
      "6. Returned portion after negotiations"
    ],
    mitigations: [
      "Use TWAP (Time-Weighted Average Price) oracles",
      "Require multiple price sources",
      "Add liquidity requirements for price feeds",
      "Implement price manipulation detection"
    ],
    references: [
      "Mango Markets Exploit Analysis - October 2022",
      "CertiK: 2022 Solana Exploits Overview"
    ]
  },
  {
    id: "crema-finance-2023",
    name: "Crema Finance Exploit",
    date: "July 2023",
    chain: "Solana",
    category: "DeFi",
    lossAmount: "$9M",
    lossAmountUSD: 9000000,
    attackType: ["flash-loan", "oracle-manipulation"],
    description: "Flash loan attack on Solana DEX manipulated asset prices to drain funds",
    technicalDetails: "Attacker exploited vulnerabilities in smart contracts to manipulate prices via flash loans",
    rootCause: "Vulnerable price calculation, insufficient protection against flash loan manipulation",
    attackSteps: [
      "1. Initiated flash loan",
      "2. Manipulated asset prices in Crema pools",
      "3. Executed profitable trades at manipulated prices",
      "4. Repaid flash loan",
      "5. Kept profit, draining protocol funds"
    ],
    mitigations: [
      "TWAP implementation",
      "Flash loan detection",
      "Multiple price sources",
      "Enhanced security audits"
    ],
    references: [
      "Crema Finance Incident - July 2023",
      "Axios: Cybercriminal Deal with DeFi Victims"
    ]
  },
  {
    id: "cypher-protocol-2023",
    name: "Cypher Protocol Exploit",
    date: "August 2023",
    chain: "Solana",
    category: "DeFi",
    lossAmount: "$1M",
    lossAmountUSD: 1000000,
    attackType: ["missing-signer-check", "margin-trading-exploit"],
    description: "Exploit in margin/futures trading logic allowed unauthorized access to funds",
    technicalDetails: "Vulnerability in Cypher's program, particularly in margin or futures trading logic. Around $600K frozen on exchanges.",
    rootCause: "Missing signer checks or improper access control in trading logic",
    attackSteps: [
      "1. Identified vulnerability in margin trading logic",
      "2. Exploited unauthorized access to funds",
      "3. Drained $1M in SOL and USDC",
      "4. Funds partially frozen on exchanges"
    ],
    mitigations: [
      "Proper signer validation",
      "Enhanced access controls",
      "Comprehensive security audits",
      "Freeze mechanisms for suspicious activity"
    ],
    references: [
      "Cypher Protocol Exploit - August 2023",
      "Helius: Solana Hacks",
      "Cointelegraph: Cypher Protocol Funds Frozen"
    ]
  },
  {
    id: "cypher-insider-2024",
    name: "Cypher Protocol Insider Theft",
    date: "May 2024",
    chain: "Solana",
    category: "DeFi",
    lossAmount: "$300K",
    lossAmountUSD: 300000,
    attackType: ["insider-threat", "missing-signer-check"],
    description: "Core developer misappropriated $300K from redemption contract via 36 unauthorized withdrawals",
    technicalDetails: "Developer 'Hoak' conducted unauthorized withdrawals from redemption contract established to reimburse users from August 2023 exploit. Funds gambled away.",
    rootCause: "Insufficient access controls on redemption contract, insider abuse of privileges",
    attackSteps: [
      "1. Developer accessed redemption contract",
      "2. Conducted 36 unauthorized withdrawals over months",
      "3. Diverted $300K to personal accounts",
      "4. Gambled funds away",
      "5. Confessed in May 2024"
    ],
    mitigations: [
      "Multi-signature requirements for fund withdrawals",
      "Time-locks on critical functions",
      "Regular audits of access controls",
      "Separation of duties",
      "Monitoring and alerting for suspicious activity"
    ],
    references: [
      "Cointelegraph: Cypher Developer Gambling Scandal - May 2024",
      "Solana Smart Contract Security Best Practices"
    ]
  },
  {
    id: "dexx-2024",
    name: "DEXX Exploit",
    date: "2024",
    chain: "Solana",
    category: "DeFi",
    lossAmount: "$30M",
    lossAmountUSD: 30000000,
    attackType: ["access-control", "logic-error"],
    description: "Vulnerability in DEXX platform exploited, highlighting importance of robust access controls",
    technicalDetails: "Exploit demonstrated need for continuous monitoring and robust access controls in DeFi platforms",
    rootCause: "Access control vulnerability or logic error",
    attackSteps: [
      "1. Identified vulnerability in DEXX platform",
      "2. Exploited access control or logic flaw",
      "3. Drained $30M from protocol"
    ],
    mitigations: [
      "Robust access controls",
      "Continuous monitoring",
      "Regular security audits",
      "Circuit breakers"
    ],
    references: [
      "Helius: Solana Hacks",
      "DEXX Exploit Analysis"
    ]
  },
  {
    id: "pump-fun-2024",
    name: "Pump.Fun Exploit",
    date: "2024",
    chain: "Solana",
    category: "DeFi",
    lossAmount: "$1.9M",
    lossAmountUSD: 1900000,
    attackType: ["logic-error", "rapid-deployment"],
    description: "Exploit in Pump.Fun platform, highlighting risks of rapid deployment without thorough audits",
    technicalDetails: "Incident underscored risks of rapid development and deployment without security audits",
    rootCause: "Insufficient security audits, rapid deployment practices",
    attackSteps: [
      "1. Identified vulnerability in Pump.Fun",
      "2. Exploited logic flaw",
      "3. Drained $1.9M"
    ],
    mitigations: [
      "Thorough security audits before launch",
      "Slow rollout with testing",
      "Bug bounty programs",
      "Comprehensive testing"
    ],
    references: [
      "Pump.Fun Exploit - 2024",
      "Medium: Solana Security Saga"
    ]
  },
  {
    id: "loopscale-2025",
    name: "Loopscale Exploit",
    date: "April 2025",
    chain: "Solana",
    category: "DeFi",
    lossAmount: "$5.8M",
    lossAmountUSD: 5800000,
    attackType: ["pricing-manipulation", "lending-exploit"],
    description: "Vulnerability in pricing mechanism exploited, attacker manipulated loan conditions to extract funds",
    technicalDetails: "Attacker manipulated pricing mechanism to exploit loan conditions and drain vaults",
    rootCause: "Vulnerable pricing mechanism in lending protocol",
    attackSteps: [
      "1. Identified pricing mechanism vulnerability",
      "2. Manipulated loan conditions",
      "3. Extracted funds from protocol vaults",
      "4. Drained $5.8M"
    ],
    mitigations: [
      "Robust pricing mechanisms",
      "TWAP implementation",
      "Multiple price sources",
      "Enhanced security audits"
    ],
    references: [
      "DeFi REKT Report April 2025",
      "Loopscale Exploit Analysis"
    ]
  },

  // ===== ETHEREUM DEFI EXPLOITS =====
  {
    id: "euler-finance-2023",
    name: "Euler Finance Exploit",
    date: "March 2023",
    chain: "Ethereum",
    category: "DeFi",
    lossAmount: "$197M",
    lossAmountUSD: 197000000,
    attackType: ["reentrancy", "flash-loan", "logic-error"],
    description: "Vulnerability in donateToReserves function allowed manipulation of equity and debt tokens, creating unbacked debt",
    technicalDetails: "eIP-14 introduced donateToReserves function without health check. Attacker used flash loans to create leveraged position, donated eTokens to reserves, triggered liquidation mechanism to acquire collateral at discount.",
    rootCause: "donateToReserves function allowed donations without health check, enabling manipulation of account equity/debt",
    attackSteps: [
      "1. Used flash loans to create leveraged position",
      "2. Donated large amount of eTokens to reserves (no health check)",
      "3. Manipulated equity and debt tokens",
      "4. Created unbacked debt that couldn't be liquidated",
      "5. Triggered liquidation mechanism",
      "6. Acquired collateral at discount and withdrew funds"
    ],
    mitigations: [
      "Health checks on all state-changing functions",
      "Reentrancy guards",
      "Thorough testing of new features",
      "Comprehensive security audits",
      "Slow rollout of protocol upgrades"
    ],
    references: [
      "BlockSec: Euler Finance Exploit Analysis",
      "CertiK: Euler Finance Incident Report",
      "Cointelegraph: Euler Finance Blocks Vulnerable Module"
    ]
  },
  {
    id: "beanstalk-2022",
    name: "Beanstalk Farms Governance Exploit",
    date: "April 2022",
    chain: "Ethereum",
    category: "DeFi",
    lossAmount: "$182M",
    lossAmountUSD: 182000000,
    attackType: ["governance-flash-loan", "flash-loan"],
    description: "Flash loan used to acquire majority governance tokens, pass malicious proposal transferring all funds",
    technicalDetails: "Attacker borrowed assets via flash loan, purchased majority of Stalk (governance tokens), passed proposal transferring all protocol funds, converted to ETH and laundered through Tornado Cash. $80M profit after loan repayment.",
    rootCause: "No time-lock on governance proposals, governance tokens tradeable via flash loans",
    attackSteps: [
      "1. Initiated flash loan to borrow large amount",
      "2. Purchased majority of Stalk governance tokens",
      "3. Submitted malicious proposal to transfer all funds",
      "4. Voted with acquired tokens to pass proposal",
      "5. Executed proposal, draining $182M",
      "6. Repaid flash loan, kept $80M profit",
      "7. Laundered funds through Tornado Cash"
    ],
    mitigations: [
      "Time-locks on governance proposals",
      "Minimum voting periods",
      "Flash loan detection",
      "Staking requirements before voting",
      "Multi-sig for critical operations"
    ],
    references: [
      "Coindesk: Beanstalk Drained $182M",
      "DN Institute: Beanstalk Attack Analysis",
      "Beanstalk: Governance Exploit Blog Post"
    ]
  },
  {
    id: "conic-finance-2023",
    name: "Conic Finance Exploit",
    date: "July 2023",
    chain: "Ethereum",
    category: "DeFi",
    lossAmount: "1,700 ETH ($3.3M)",
    lossAmountUSD: 3300000,
    attackType: ["read-only-reentrancy", "flash-loan", "oracle-manipulation"],
    description: "Read-only reentrancy vulnerability combined with flash loans and front-running to manipulate asset prices",
    technicalDetails: "Read-only reentrancy attack on Ether Omnipool. Attacker combined reentrancy with flash loans and front-running techniques. Protocol eventually shut down in 2024 after failing to resolve security flaws.",
    rootCause: "Read-only reentrancy vulnerability allowing state manipulation during external calls",
    attackSteps: [
      "1. Identified read-only reentrancy vulnerability",
      "2. Combined with flash loans",
      "3. Used front-running techniques",
      "4. Manipulated asset prices in Omnipool",
      "5. Extracted $3.3M"
    ],
    mitigations: [
      "Reentrancy guards on all external calls",
      "Checks-effects-interactions pattern",
      "Avoid state reads during external calls",
      "Comprehensive security audits"
    ],
    references: [
      "Coindesk: Conic Finance Hacked - July 2023",
      "Conic Finance Exploit Analysis"
    ]
  },
  {
    id: "sturdy-finance-2023",
    name: "Sturdy Finance Exploit",
    date: "June 2023",
    chain: "Ethereum",
    category: "DeFi",
    lossAmount: "$800K",
    lossAmountUSD: 800000,
    attackType: ["oracle-manipulation", "pricing-manipulation"],
    description: "Attacker exploited price oracle vulnerability to manipulate asset prices and drain liquidity pool",
    technicalDetails: "Vulnerability in protocol's price oracle allowed manipulation of asset prices",
    rootCause: "Weak oracle implementation vulnerable to price manipulation",
    attackSteps: [
      "1. Identified oracle vulnerability",
      "2. Manipulated asset prices",
      "3. Drained funds from liquidity pool",
      "4. Protocol suspended all transactions"
    ],
    mitigations: [
      "Robust oracle implementation",
      "TWAP oracles",
      "Multiple price sources",
      "Price manipulation detection"
    ],
    references: [
      "BingX: Sturdy Finance Exploit - June 2023"
    ]
  },
  {
    id: "polter-finance-2024",
    name: "Polter Finance Exploit",
    date: "November 2024",
    chain: "Ethereum",
    category: "DeFi",
    lossAmount: "$12M",
    lossAmountUSD: 12000000,
    attackType: ["flash-loan", "oracle-manipulation"],
    description: "Flash loan used to artificially inflate BOO token price in SpookySwap pools, enabling excessive borrowing",
    technicalDetails: "Attacker leveraged flash loans to manipulate BOO token price within SpookySwap liquidity pools, allowing borrowing far exceeding actual collateral value",
    rootCause: "Vulnerable oracle using single DEX price source, no TWAP protection",
    attackSteps: [
      "1. Initiated flash loan",
      "2. Artificially inflated BOO price in SpookySwap pools",
      "3. Borrowed assets exceeding actual collateral value",
      "4. Repaid flash loan",
      "5. Kept profit, draining $12M"
    ],
    mitigations: [
      "TWAP implementation",
      "Multiple price sources",
      "Flash loan detection",
      "Enhanced oracle security"
    ],
    references: [
      "ThreeSigma: 2024 DeFi Exploits Top Vulnerabilities",
      "Polter Finance Exploit Analysis"
    ]
  },
  {
    id: "nebula-revelation-2024",
    name: "Nebula Revelation Reentrancy Attack",
    date: "January 2024",
    chain: "Ethereum",
    category: "DeFi",
    lossAmount: "$180K",
    lossAmountUSD: 180264,
    attackType: ["reentrancy", "staking-exploit"],
    description: "Reentrancy attack on staking contract allowed unauthorized token withdrawal",
    technicalDetails: "Attacker exploited reentrancy vulnerability in staking contract using self-destructing contract to complete all operations in single transaction",
    rootCause: "Reentrancy vulnerability in staking contract withdrawal logic",
    attackSteps: [
      "1. Identified reentrancy vulnerability in staking contract",
      "2. Deployed self-destructing contract",
      "3. Exploited reentrancy to withdraw tokens multiple times",
      "4. Completed all operations in single transaction",
      "5. Drained $180K"
    ],
    mitigations: [
      "Reentrancy guards",
      "Checks-effects-interactions pattern",
      "State updates before external calls",
      "Comprehensive security audits"
    ],
    references: [
      "Medium: Biggest DeFi Hacks of January 2024",
      "Nebula Revelation Exploit Analysis"
    ]
  },

  // ===== WALLET & KEY MANAGEMENT =====
  {
    id: "slope-wallet-2022",
    name: "Slope Wallet Breach",
    date: "August 2022",
    chain: "Solana",
    category: "Wallet",
    lossAmount: "$8M",
    lossAmountUSD: 8000000,
    attackType: ["supply-chain-compromise", "private-key-compromise"],
    description: "Supply chain attack compromised Slope Wallet, leading to theft from 8,000 user wallets",
    technicalDetails: "Vulnerability in wallet's security infrastructure, traced to supply chain compromise",
    rootCause: "Supply chain attack on wallet infrastructure, compromised dependencies",
    attackSteps: [
      "1. Compromised wallet's supply chain",
      "2. Injected malicious code",
      "3. Stole private keys from 8,000 wallets",
      "4. Drained $8M in funds"
    ],
    mitigations: [
      "Supply chain security audits",
      "Dependency scanning",
      "Secure key storage",
      "Hardware wallet integration",
      "Regular security updates"
    ],
    references: [
      "CertiK: 2022 Solana Exploits Overview",
      "Slope Wallet Breach Investigation"
    ]
  },
  {
    id: "upbit-2025",
    name: "Upbit Exchange Hack",
    date: "November 2025",
    chain: "Solana",
    category: "Exchange",
    lossAmount: "$30M",
    lossAmountUSD: 30000000,
    attackType: ["private-key-compromise", "nonce-bias"],
    description: "Nonce bias vulnerability allowed attackers to infer private keys by analyzing transaction signatures",
    technicalDetails: "Predictable patterns in Upbit's signing process enabled attackers to deduce private keys by analyzing millions of blockchain signatures. Flaw in nonce generation within Solana transactions.",
    rootCause: "Predictable nonce generation in cryptographic signatures, nonce bias vulnerability",
    attackSteps: [
      "1. Identified predictable nonce patterns in Upbit transactions",
      "2. Analyzed millions of blockchain signatures",
      "3. Inferred private keys from nonce bias",
      "4. Accessed Solana hot wallet",
      "5. Drained $30M in TRUMP, BONK, USDC tokens"
    ],
    mitigations: [
      "Cryptographically secure random nonce generation",
      "Hardware security modules (HSM)",
      "Key rotation policies",
      "Separate hot/cold wallet infrastructure",
      "Regular security audits"
    ],
    references: [
      "CyberNews: Upbit Security Flaw - November 2025",
      "CoinCentral: Upbit Hack Nonce Bias",
      "MEXC: Upbit $30M Theft Report"
    ]
  },

  // ===== EXIT SCAMS =====
  {
    id: "libra-exit-scam-2025",
    name: "LIBRA Exit Scam",
    date: "February 2025",
    chain: "Solana",
    category: "Exit Scam",
    lossAmount: "Part of $486M",
    lossAmountUSD: 0, // Combined with MELANIA
    attackType: ["exit-scam", "rug-pull"],
    description: "Large-scale exit scam on Solana, project team drained user funds and disappeared",
    technicalDetails: "Project team used admin keys to drain user funds",
    rootCause: "Centralized admin keys, no time-locks, lack of transparency",
    attackSteps: [
      "1. Launched protocol and attracted deposits",
      "2. Accumulated significant TVL",
      "3. Used admin keys to drain funds",
      "4. Disappeared"
    ],
    mitigations: [
      "KYC for project teams",
      "Multi-sig with time-locks",
      "Security audits",
      "Decentralized governance",
      "Transparency requirements"
    ],
    references: [
      "DeFi REKT Report Q1 2025"
    ],
    relatedExploits: ["melania-exit-scam-2025"]
  },
  {
    id: "melania-exit-scam-2025",
    name: "MELANIA Exit Scam",
    date: "February 2025",
    chain: "Solana",
    category: "Exit Scam",
    lossAmount: "Part of $486M",
    lossAmountUSD: 0, // Combined with LIBRA
    attackType: ["exit-scam", "rug-pull"],
    description: "Large-scale exit scam on Solana, combined with LIBRA totaling $486M",
    technicalDetails: "Project team used admin keys to drain user funds",
    rootCause: "Centralized admin keys, no time-locks, lack of transparency",
    attackSteps: [
      "1. Launched protocol and attracted deposits",
      "2. Accumulated significant TVL",
      "3. Used admin keys to drain funds",
      "4. Disappeared"
    ],
    mitigations: [
      "KYC for project teams",
      "Multi-sig with time-locks",
      "Security audits",
      "Decentralized governance",
      "Transparency requirements"
    ],
    references: [
      "DeFi REKT Report Q1 2025"
    ],
    relatedExploits: ["libra-exit-scam-2025"]
  },

  // ===== ORACLE MANIPULATION =====
  {
    id: "typus-finance-2025",
    name: "Typus Finance Oracle Manipulation",
    date: "October 2025",
    chain: "Ethereum",
    category: "DeFi",
    lossAmount: "$3.44M",
    lossAmountUSD: 3440000,
    attackType: ["oracle-manipulation"],
    description: "Oracle manipulation led to $3.44M loss, highlighting ongoing vulnerabilities",
    technicalDetails: "Attacker manipulated oracle prices to exploit protocol",
    rootCause: "Weak oracle implementation vulnerable to manipulation",
    attackSteps: [
      "1. Identified oracle vulnerability",
      "2. Manipulated price feeds",
      "3. Exploited protocol using manipulated prices",
      "4. Drained $3.44M"
    ],
    mitigations: [
      "TWAP implementation",
      "Multiple price sources",
      "Oracle manipulation detection",
      "Enhanced security audits"
    ],
    references: [
      "DeFi REKT Report October 2025"
    ]
  }
];

/**
 * Get exploit by ID
 */
export function getExploitById(id: string): RealWorldExploit | undefined {
  return REAL_WORLD_EXPLOITS.find(e => e.id === id);
}

/**
 * Get exploits by attack type
 */
export function getExploitsByAttackType(attackType: string): RealWorldExploit[] {
  return REAL_WORLD_EXPLOITS.filter(e => e.attackType.includes(attackType));
}

/**
 * Get exploits by chain
 */
export function getExploitsByChain(chain: string): RealWorldExploit[] {
  return REAL_WORLD_EXPLOITS.filter(e => 
    e.chain.toLowerCase().includes(chain.toLowerCase())
  );
}

/**
 * Get exploits by category
 */
export function getExploitsByCategory(category: string): RealWorldExploit[] {
  return REAL_WORLD_EXPLOITS.filter(e => 
    e.category.toLowerCase() === category.toLowerCase()
  );
}

/**
 * Get total losses by category
 */
export function getTotalLossesByCategory(): Record<string, number> {
  const losses: Record<string, number> = {};
  REAL_WORLD_EXPLOITS.forEach(exploit => {
    if (!losses[exploit.category]) {
      losses[exploit.category] = 0;
    }
    losses[exploit.category] += exploit.lossAmountUSD;
  });
  return losses;
}

/**
 * Get all unique attack types
 */
export function getAllAttackTypes(): string[] {
  const types = new Set<string>();
  REAL_WORLD_EXPLOITS.forEach(exploit => {
    exploit.attackType.forEach(type => types.add(type));
  });
  return Array.from(types).sort();
}
