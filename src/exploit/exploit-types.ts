/**
 * Type definitions for exploit strategies and fuzzing
 */

import { PublicKey, TransactionInstruction } from "@solana/web3.js";

/**
 * IDL structure (simplified)
 */
export interface IdlInstruction {
  name: string;
  discriminator?: string | number[];
  accounts?: IdlAccount[];
  args?: IdlField[];
}

export interface IdlAccount {
  name: string;
  isMut?: boolean;
  isSigner?: boolean;
  isWritable?: boolean;
  writable?: boolean;
  signer?: boolean;
  pubkey?: string;
}

export interface IdlField {
  name: string;
  type: any;
}

export interface Idl {
  name: string;
  instructions: IdlInstruction[];
  accounts?: any[];
  types?: any[];
}

/**
 * Context for building exploit instructions
 */
export interface ExploitContext {
  idl: Idl;
  programId: PublicKey;
  accounts: IdlAccount[];
  fuzzPayload?: Buffer;
  vulnerability?: any;
}

/**
 * Exploit strategy interface
 */
export interface ExploitStrategy {
  name: string;
  description: string;
  buildInstruction: (context: ExploitContext) => Promise<TransactionInstruction | null>;
  fuzzPayloads?: Buffer[];
}

/**
 * Account initialization result
 */
export interface InitializedAccounts {
  mint?: PublicKey;
  ata?: PublicKey;
  pda?: PublicKey;
  state?: PublicKey;
  payer: PublicKey;
  [key: string]: PublicKey | undefined;
}

